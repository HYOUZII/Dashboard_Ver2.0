<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—°êµ¬ì†Œ ì—…ë¬´ íˆ¬ëª…í™” ëŒ€ì‹œë³´ë“œ</title>
    <style>
        /* ==========================================
           ê¸€ë¡œë²Œ ë³€ìˆ˜ ë° ë¦¬ì…‹
        ========================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #2c5aa0;
            --secondary-color: #5b8fd9;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-bg: #f8f9fa;
            --dark-text: #212529;
            --border-color: #dee2e6;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        body {
            font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
            font-size: 18px;
            line-height: 1.6;
            color: var(--dark-text);
            background-color: var(--light-bg);
            min-height: 100vh;
        }
        
        /* ==========================================
           í—¤ë”
        ========================================== */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: bold;
        }
        
        .user-info {
            text-align: right;
            font-size: 16px;
        }
        
        .user-name {
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .permission-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            background: rgba(255,255,255,0.2);
            font-size: 14px;
        }
        
        /* ==========================================
           ë„¤ë¹„ê²Œì´ì…˜
        ========================================== */
        .nav-container {
            background: white;
            padding: 15px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .nav-btn {
            background: white;
            border: 3px solid var(--primary-color);
            color: var(--primary-color);
            padding: 18px 12px;
            font-size: 19px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .nav-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ==========================================
           ì½˜í…ì¸  ì˜ì—­
        ========================================== */
        .content-container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }
        
        .page {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* ==========================================
           ì¹´ë“œ
        ========================================== */
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--primary-color);
        }
        
        .card-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--primary-color);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 12px;
        }
        
        /* ==========================================
           í†µê³„ ì¹´ë“œ
        ========================================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--primary-color);
        }
        
        .stat-card.warning { border-top-color: var(--warning-color); }
        .stat-card.danger { border-top-color: var(--danger-color); background: #fff5f5; }
        .stat-card.success { border-top-color: var(--success-color); }
        
        .stat-label {
            font-size: 18px;
            color: #666;
            margin-bottom: 12px;
        }
        
        .stat-value {
            font-size: 42px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .stat-card.warning .stat-value { color: var(--warning-color); }
        .stat-card.danger .stat-value { color: var(--danger-color); }
        .stat-card.success .stat-value { color: var(--success-color); }
        
        .stat-unit {
            font-size: 20px;
            color: #888;
        }
        
        /* ==========================================
           ë²„íŠ¼
        ========================================== */
        .btn {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 55px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #1e4070;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #1e7e34;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* ==========================================
           í¼
        ========================================== */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--dark-text);
        }
        
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px;
            font-size: 17px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-family: inherit;
        }
        
        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }
        
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        /* ==========================================
           í…Œì´ë¸”
        ========================================== */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 16px;
        }
        
        th {
            background: var(--primary-color);
            color: white;
            padding: 16px 12px;
            text-align: left;
            font-size: 18px;
            font-weight: bold;
        }
        
        td {
            padding: 14px 12px;
            border-bottom: 1px solid var(--border-color);
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        /* ==========================================
           ë¡œë”© & ì•Œë¦¼
        ========================================== */
        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 22px;
            color: #666;
        }
        
        .loading::after {
            content: '...';
            animation: dots 1.5s infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        .alert {
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 17px;
            border-left: 5px solid;
        }
        
        .alert-success {
            background: #d4edda;
            border-color: var(--success-color);
            color: #155724;
        }
        
        .alert-danger {
            background: #f8d7da;
            border-color: var(--danger-color);
            color: #721c24;
        }
        
        .alert-warning {
            background: #fff3cd;
            border-color: var(--warning-color);
            color: #856404;
        }
        
        .alert-info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }
        
        /* ==========================================
           ëª¨ë‹¬
        ========================================== */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .modal-footer {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        /* ==========================================
           ë°˜ì‘í˜•
        ========================================== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }
            
            .nav-btn {
                font-size: 17px;
                padding: 15px 10px;
                min-height: 65px;
            }
            
            .stat-value {
                font-size: 36px;
            }
            
            .card-title {
                font-size: 22px;
            }
        }
        
        /* ==========================================
           ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤
        ========================================== */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <!-- í—¤ë” -->
    <div class="header">
        <div class="header-content">
            <div>
                <h1>ğŸ”¬ ì—°êµ¬ì†Œ ì—…ë¬´ íˆ¬ëª…í™” ëŒ€ì‹œë³´ë“œ</h1>
                <p style="font-size: 16px; opacity: 0.95;">ì‹¤ì‹œê°„ ì—…ë¬´ ê°€ì‹œì„± & ì¸í„°ëŸ½íŠ¸ ê´€ë¦¬</p>
            </div>
            <div class="user-info">
                <div class="user-name"><?= userName ?></div>
                <div class="permission-badge" id="permission-display"><?= permission ?></div>
            </div>
        </div>
    </div>
    
    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="nav-container">
        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showPage('dashboard')" id="nav-dashboard">
                ğŸ“Š ëŒ€ì‹œë³´ë“œ
            </button>
            <button class="nav-btn" onclick="showPage('projects')" id="nav-projects">
                ğŸ“‹ í”„ë¡œì íŠ¸
            </button>
            <button class="nav-btn" onclick="showPage('interrupt')" id="nav-interrupt">
                âš¡ ì¸í„°ëŸ½íŠ¸
            </button>
            <button class="nav-btn" onclick="showPage('assets')" id="nav-assets">
                ğŸ“ ìì‚°
            </button>
            <button class="nav-btn" onclick="showPage('voc')" id="nav-voc">
                ğŸ’¬ VOC
            </button>
            <button class="nav-btn" onclick="showPage('settings')" id="nav-settings">
                âš™ï¸ ì„¤ì •
            </button>
        </div>
    </div>
    
    <!-- ì½˜í…ì¸  ì˜ì—­ -->
    <div class="content-container">
        <!-- ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ -->
        <div id="page-dashboard" class="page active">
            <div class="loading" id="dashboard-loading">ë°ì´í„° ë¡œë”© ì¤‘</div>
            <div id="dashboard-content" style="display: none;">
                <!-- í†µê³„ ì¹´ë“œ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">ì§„í–‰ì¤‘ì¸ í”„ë¡œì íŠ¸</div>
                        <div class="stat-value" id="stat-projects-active">0</div>
                        <div class="stat-unit">ê°œ</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-label">ì´ë²ˆ ì£¼ ì¸í„°ëŸ½íŠ¸</div>
                        <div class="stat-value" id="stat-interrupts-week">0</div>
                        <div class="stat-unit">ê±´</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-label">í‰ê·  ì¸í„°ëŸ½íŠ¸ ë¹„ìœ¨</div>
                        <div class="stat-value" id="stat-interrupt-ratio">0</div>
                        <div class="stat-unit">%</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-label">ê³¼ë¶€í•˜ íŒ€ì›</div>
                        <div class="stat-value" id="stat-overloaded">0</div>
                        <div class="stat-unit">ëª…</div>
                    </div>
                </div>
                
                <!-- í”„ë¡œì íŠ¸ í˜„í™© -->
                <div class="card">
                    <div class="card-title">í”„ë¡œì íŠ¸ í˜„í™©</div>
                    <div id="project-overview"></div>
                </div>
                
                <!-- ì¸í„°ëŸ½íŠ¸ ë¶„ì„ -->
                <div class="card">
                    <div class="card-title">ì¸í„°ëŸ½íŠ¸ ë¶„ì„ (ë¶€ì„œë³„)</div>
                    <div id="interrupt-analysis"></div>
                </div>
                
                <!-- íŒ€ì›ë³„ ì›Œí¬ë¡œë“œ -->
                <div class="card">
                    <div class="card-title">íŒ€ì›ë³„ ì›Œí¬ë¡œë“œ</div>
                    <div id="member-workload"></div>
                </div>
            </div>
        </div>
        
        <!-- í”„ë¡œì íŠ¸ í˜ì´ì§€ -->
        <div id="page-projects" class="page">
            <div class="card">
                <div class="card-title">í”„ë¡œì íŠ¸ ê´€ë¦¬</div>
                <p style="font-size: 17px; color: #666; margin-bottom: 20px;">
                    ì—°êµ¬ì†Œ PM ì „ìš© ê¸°ëŠ¥ì…ë‹ˆë‹¤.
                </p>
                <div id="projects-content">
                    <div class="loading">í”„ë¡œì íŠ¸ ë°ì´í„° ë¡œë”© ì¤‘</div>
                </div>
            </div>
        </div>
        
        <!-- ì¸í„°ëŸ½íŠ¸ í˜ì´ì§€ -->
        <div id="page-interrupt" class="page">
            <div class="card">
                <div class="card-title">âš¡ ê¸´ê¸‰ ì—…ë¬´(ì¸í„°ëŸ½íŠ¸) ë“±ë¡</div>
                <p style="font-size: 17px; color: #666; margin-bottom: 25px;">
                    ê°‘ì‘ìŠ¤ëŸ½ê²Œ ë°œìƒí•œ ì—…ë¬´ë¥¼ ì¦‰ì‹œ ê¸°ë¡í•˜ì—¬ ì—…ë¬´ ë¶€í•˜ë¥¼ ê°€ì‹œí™”í•©ë‹ˆë‹¤.
                </p>
                
                <div id="interrupt-alert"></div>
                
                <form id="interrupt-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ë‹´ë‹¹ì *</label>
                            <select class="form-select" id="interrupt-member" required>
                                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ìš”ì²­ ë¶€ì„œ *</label>
                            <input type="text" class="form-input" id="interrupt-dept" required 
                                   placeholder="ì˜ˆ: ìƒì‚°íŒ€">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ìš”ì²­ì</label>
                            <input type="text" class="form-input" id="interrupt-requester" 
                                   placeholder="ì˜ˆ: ë°•ìƒì‚°">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ì˜ˆìƒ ì†Œìš”ì‹œê°„ (ì‹œê°„) *</label>
                            <input type="number" class="form-input" id="interrupt-hours" 
                                   min="0.5" step="0.5" required placeholder="ì˜ˆ: 2.5">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì¤‘ìš”ë„ *</label>
                            <select class="form-select" id="interrupt-importance" required>
                                <option value="ë†’ìŒ">ë†’ìŒ</option>
                                <option value="ë³´í†µ" selected>ë³´í†µ</option>
                                <option value="ë‚®ìŒ">ë‚®ìŒ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ê¸´ê¸‰ë„ *</label>
                            <select class="form-select" id="interrupt-urgency" required>
                                <option value="ë†’ìŒ">ë†’ìŒ</option>
                                <option value="ë³´í†µ" selected>ë³´í†µ</option>
                                <option value="ë‚®ìŒ">ë‚®ìŒ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì—…ë¬´ ìƒì„¸ ë‚´ìš© *</label>
                        <textarea class="form-textarea" id="interrupt-content" required 
                                  placeholder="ì˜ˆ: ìƒì‚°íŒ€ ê¸´ê¸‰ íšŒë¡œ ìˆ˜ì • ìš”ì²­ - PCB ë ˆì´ì•„ì›ƒ ë³€ê²½"></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        ğŸ“ ì¸í„°ëŸ½íŠ¸ ê¸°ë¡ ì €ì¥
                    </button>
                </form>
            </div>
            
            <!-- ìµœê·¼ ì¸í„°ëŸ½íŠ¸ ê¸°ë¡ -->
            <div class="card">
                <div class="card-title">ìµœê·¼ ì¸í„°ëŸ½íŠ¸ ê¸°ë¡</div>
                <div id="interrupt-log"></div>
            </div>
        </div>
        
        <!-- ìì‚° í˜ì´ì§€ -->
        <div id="page-assets" class="page">
            <div class="card">
                <div class="card-title">ë² ì´ìŠ¤ë¼ì¸ & ìì‚° ê´€ë¦¬</div>
                <div id="assets-content">
                    <div class="loading">ìì‚° ë°ì´í„° ë¡œë”© ì¤‘</div>
                </div>
            </div>
        </div>
        
        <!-- VOC í˜ì´ì§€ -->
        <div id="page-voc" class="page">
            <div class="card">
                <div class="card-title">ğŸ’¬ VOC (ê³ ê°ì˜ ì†Œë¦¬) ë“±ë¡</div>
                <p style="font-size: 17px; color: #666; margin-bottom: 25px;">
                    ì œí’ˆ ë¶ˆë§Œ, ê°œì„  ìš”ì²­, ì•„ì´ë””ì–´ë¥¼ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.
                </p>
                
                <div id="voc-alert"></div>
                
                <form id="voc-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">êµ¬ë¶„ *</label>
                            <select class="form-select" id="voc-type" required>
                                <option value="ë¶ˆë§Œ">ë¶ˆë§Œ (ì œí’ˆ/ì„œë¹„ìŠ¤ ë¬¸ì œ)</option>
                                <option value="ìš”ì²­">ìš”ì²­ (ìƒˆë¡œìš´ ê¸°ëŠ¥)</option>
                                <option value="ê°œì„ ì œì•ˆ">ê°œì„ ì œì•ˆ (í”„ë¡œì„¸ìŠ¤/ë¬¸ì„œ)</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ì œí’ˆ ëª¨ë¸ *</label>
                            <input type="text" class="form-input" id="voc-product" required 
                                   placeholder="ì˜ˆ: AC-7KW-V1">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">ì¹´í…Œê³ ë¦¬ *</label>
                            <select class="form-select" id="voc-category" required>
                                <option value="íŒì›¨ì–´">íŒì›¨ì–´</option>
                                <option value="APP">APP</option>
                                <option value="í•˜ë“œì›¨ì–´">í•˜ë“œì›¨ì–´</option>
                                <option value="ê¸°êµ¬">ê¸°êµ¬</option>
                                <option value="ë¬¸ì„œ">ë¬¸ì„œ</option>
                                <option value="ì„œë¹„ìŠ¤">ì„œë¹„ìŠ¤</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ìš°ì„ ìˆœìœ„ *</label>
                            <select class="form-select" id="voc-priority" required>
                                <option value="ë†’ìŒ">ë†’ìŒ</option>
                                <option value="ë³´í†µ" selected>ë³´í†µ</option>
                                <option value="ë‚®ìŒ">ë‚®ìŒ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì œëª© *</label>
                        <input type="text" class="form-input" id="voc-title" required 
                               placeholder="ì˜ˆ: ì¶©ì „ ì¤‘ ì¬ë¶€íŒ… ë°œìƒ">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ë‚´ìš© *</label>
                        <textarea class="form-textarea" id="voc-content" required 
                                  placeholder="ë¬¸ì œ ìƒí™©ì´ë‚˜ ê°œì„  ì•„ì´ë””ì–´ë¥¼ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ì²¨ë¶€ íŒŒì¼ ë§í¬ (ì„ íƒ)</label>
                        <input type="text" class="form-input" id="voc-file" 
                               placeholder="Google Drive ë§í¬ ë“±">
                    </div>
                    
                    <button type="submit" class="btn btn-success" style="width: 100%;">
                        ğŸ“¤ VOC ì œì¶œí•˜ê¸°
                    </button>
                </form>
            </div>
            
            <!-- VOC ëª©ë¡ -->
            <div class="card">
                <div class="card-title">VOC ëª©ë¡</div>
                <div id="voc-list">
                    <div class="loading">VOC ë°ì´í„° ë¡œë”© ì¤‘</div>
                </div>
            </div>
        </div>
        
        <!-- ì„¤ì • í˜ì´ì§€ -->
        <div id="page-settings" class="page">
            <div class="card">
                <div class="card-title">âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì •</div>
                <div id="settings-content">
                    <p style="font-size: 17px; color: #666;">
                        ê¶Œí•œ ê´€ë¦¬ ë° ì‹œìŠ¤í…œ ì„¤ì •ì€ FULL_ACCESS ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ë‚ ì§œ ì½”ë“œ ì…ë ¥ ëª¨ë‹¬ -->
    <div id="date-code-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">ğŸ”‘ ì ‘ê·¼ ì¸ì¦</div>
            <p style="font-size: 17px; margin-bottom: 20px;">
                FULL_ACCESS ê¶Œí•œ ì‚¬ìš©ì„ ìœ„í•´ ì˜¤ëŠ˜ì˜ ë‚ ì§œ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.
            </p>
            <div class="form-group">
                <label class="form-label">ë‚ ì§œ ì½”ë“œ (4ìë¦¬)</label>
                <input type="text" class="form-input" id="date-code-input" 
                       maxlength="4" placeholder="ì˜ˆ: 0229" 
                       style="text-align: center; font-size: 24px; letter-spacing: 4px;">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="verifyDateCode()">í™•ì¸</button>
            </div>
            <p style="font-size: 14px; color: #666; margin-top: 15px; text-align: center;">
                íŒíŠ¸: ì›”ì¼ + 20 (ì˜ˆ: 2ì›” 9ì¼ â†’ 0229)
            </p>
        </div>
    </div>

    <script>
        // ==========================================
        // ì „ì—­ ë³€ìˆ˜
        // ==========================================
        
        const USER_EMAIL = '<?= userEmail ?>';
        const USER_PERMISSION = '<?= permission ?>';
        const USER_NAME = '<?= userName ?>';
        
        let isDateCodeVerified = false;
        let dashboardData = null;
        
        // ==========================================
        // ì´ˆê¸°í™”
        // ==========================================
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        
        function initializeApp() {
            console.log('ëŒ€ì‹œë³´ë“œ ì´ˆê¸°í™” ì¤‘...');
            console.log('ì‚¬ìš©ì:', USER_NAME, '/', USER_EMAIL);
            console.log('ê¶Œí•œ:', USER_PERMISSION);
            
            // ê¶Œí•œë³„ UI ì¡°ì •
            adjustUIByPermission();
            
            // FULL_ACCESSì¸ ê²½ìš° ë‚ ì§œ ì½”ë“œ í™•ì¸
            if (USER_PERMISSION === 'FULL_ACCESS') {
                showDateCodeModal();
            } else {
                // ë‹¤ë¥¸ ê¶Œí•œì€ ë°”ë¡œ ë°ì´í„° ë¡œë“œ
                loadDashboardData();
            }
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            registerEventListeners();
        }
        
        function adjustUIByPermission() {
            if (USER_PERMISSION === 'DASHBOARD_ONLY') {
                // ëŒ€ì‹œë³´ë“œë§Œ í‘œì‹œ
                document.getElementById('nav-projects').disabled = true;
                document.getElementById('nav-interrupt').disabled = true;
                document.getElementById('nav-assets').disabled = true;
                document.getElementById('nav-settings').disabled = true;
            } else if (USER_PERMISSION === 'READ_ONLY') {
                // í”„ë¡œì íŠ¸, ì¸í„°ëŸ½íŠ¸ ë¹„í™œì„±í™”
                document.getElementById('nav-projects').disabled = true;
                document.getElementById('nav-settings').disabled = true;
            }
        }
        
        function registerEventListeners() {
            // ì¸í„°ëŸ½íŠ¸ í¼
            const interruptForm = document.getElementById('interrupt-form');
            if (interruptForm) {
                interruptForm.addEventListener('submit', handleInterruptSubmit);
            }
            
            // VOC í¼
            const vocForm = document.getElementById('voc-form');
            if (vocForm) {
                vocForm.addEventListener('submit', handleVOCSubmit);
            }
        }
        
        // ==========================================
        // í˜ì´ì§€ ì „í™˜
        // ==========================================
        
        function showPage(pageName) {
            // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ì„ íƒí•œ í˜ì´ì§€ í‘œì‹œ
            document.getElementById(`page-${pageName}`).classList.add('active');
            
            // ì„ íƒí•œ ë²„íŠ¼ í™œì„±í™”
            const activeBtn = document.getElementById(`nav-${pageName}`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // í˜ì´ì§€ë³„ ë°ì´í„° ë¡œë“œ
            loadPageData(pageName);
        }
        
        function loadPageData(pageName) {
            if (pageName === 'dashboard' && !dashboardData) {
                loadDashboardData();
            } else if (pageName === 'interrupt') {
                loadInterruptData();
            } else if (pageName === 'assets') {
                loadAssetsData();
            } else if (pageName === 'voc') {
                loadVOCData();
            } else if (pageName === 'projects') {
                loadProjectsData();
            }
        }
        
        // ==========================================
        // ë‚ ì§œ ì½”ë“œ ê²€ì¦
        // ==========================================
        
        function showDateCodeModal() {
            document.getElementById('date-code-modal').classList.add('active');
            document.getElementById('date-code-input').focus();
        }
        
        function verifyDateCode() {
            const code = document.getElementById('date-code-input').value;
            
            if (!code || code.length !== 4) {
                alert('4ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }
            
            // Apps Script í˜¸ì¶œí•˜ì—¬ ê²€ì¦
            google.script.run
                .withSuccessHandler(function(result) {
                    if (result.valid) {
                        isDateCodeVerified = true;
                        document.getElementById('date-code-modal').classList.remove('active');
                        loadDashboardData();
                    } else {
                        alert('ì˜ëª»ëœ ì½”ë“œì…ë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.');
                        document.getElementById('date-code-input').value = '';
                        document.getElementById('date-code-input').focus();
                    }
                })
                .withFailureHandler(function(error) {
                    console.error('ì½”ë“œ ê²€ì¦ ì‹¤íŒ¨:', error);
                    alert('ê²€ì¦ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');
                })
                .apiVerifyDateCode({code: code});
        }
        
        // ì—”í„°í‚¤ë¡œ ì œì¶œ
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.getElementById('date-code-modal').classList.contains('active')) {
                verifyDateCode();
            }
        });
        
        // ==========================================
        // ë°ì´í„° ë¡œë”© í•¨ìˆ˜ë“¤
        // ==========================================
        
        function loadDashboardData() {
            google.script.run
                .withSuccessHandler(function(data) {
                    dashboardData = data;
                    renderDashboard(data);
                })
                .withFailureHandler(function(error) {
                    console.error('ëŒ€ì‹œë³´ë“œ ë¡œë”© ì‹¤íŒ¨:', error);
                    showError('dashboard', 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
                })
                .apiGetDashboardStats();
        }
        
        function loadInterruptData() {
            google.script.run
                .withSuccessHandler(function(data) {
                    renderInterruptLog(data);
                })
                .withFailureHandler(function(error) {
                    console.error('ì¸í„°ëŸ½íŠ¸ ë¡œë”© ì‹¤íŒ¨:', error);
                })
                .apiGetInterrupts();
        }
        
        function loadAssetsData() {
            google.script.run
                .withSuccessHandler(function(data) {
                    renderAssets(data);
                })
                .withFailureHandler(function(error) {
                    console.error('ìì‚° ë¡œë”© ì‹¤íŒ¨:', error);
                })
                .apiGetBaselines();
        }
        
        function loadVOCData() {
            google.script.run
                .withSuccessHandler(function(data) {
                    renderVOCList(data);
                })
                .withFailureHandler(function(error) {
                    console.error('VOC ë¡œë”© ì‹¤íŒ¨:', error);
                })
                .apiGetVOCList();
        }
        
        function loadProjectsData() {
            google.script.run
                .withSuccessHandler(function(data) {
                    renderProjects(data);
                })
                .withFailureHandler(function(error) {
                    console.error('í”„ë¡œì íŠ¸ ë¡œë”© ì‹¤íŒ¨:', error);
                })
                .apiGetProjects();
        }
        
        // ê³„ì†...
    </script>
</body>
</html>